const bankSoal = {
  DTS: [
    //UK1
    {tipe:"DTS", uk:"UK1", soal:1, text:"1.1 Apakah Operator dalam kondisi sehat dan menggunakan APD Lengkap?"},
    {tipe:"DTS", uk:"UK1", soal:2, text:"1.2 Apakah Operator menggunakan sabuk pengaman?"},
    {tipe:"DTS", uk:"UK1", soal:3, text:"1.3 Apakah Operator melakukan aturan klakson?"},
    {tipe:"DTS", uk:"UK1", soal:4, text:"1.4 Apakah Operator mengaktifkan lampu unit?"},
    {tipe:"DTS", uk:"UK1", soal:5, text:"1.5 Apakah Operator mengetahui nama rambu? Sampling minimal 3"},
    {tipe:"DTS", uk:"UK1", soal:6, text:"1.6 Apakah Operator mengimplementasikan aturan rambu-rambu?"},
    {tipe:"DTS", uk:"UK1", soal:7, text:"1.7 Apakah Operator mengendarai sesuai dengan rambu kecepatan?"},
    {tipe:"DTS", uk:"UK1", soal:8, text:"1.8 Apakah Operator memahami Emergency Response saat terjadi kebakaran pada unit yang dioperasikan?"},
    {tipe:"DTS", uk:"UK1", soal:9, text:"1.9 Apakah Operator memahami Emergency Response saat terjadi steering failure pada unit yang dioperasikan?"},
    {tipe:"DTS", uk:"UK1", soal:10, text:"1.10 Apakah Operator memahami Emergency Response saat terjadi brake failure pada unit yang dioperasikan?"},
    {tipe:"DTS", uk:"UK1", soal:11, text:"1.11 Apakah Operator memahami Emergency Response saat terjadi unit breakdown di jalan pada unit yang dioperasikan?"},
    {tipe:"DTS", uk:"UK1", soal:12, text:"1.12 Apakah Operator memahami Emergency Response pasca penyiraman/jalan licin pada unit yang dioperasikan?"},

    //UK2
    {tipe:"DTS", uk:"UK2", soal:1, text:"Apakah Operator melaporkan KTA dan/atau TTA kepada Pengawas?"},
    {tipe:"DTS", uk:"UK2", soal:2, text:"Apakah Operator mengetahui metode pelaporan insiden?"},
    {tipe:"DTS", uk:"UK2", soal:3, text:"Apakah Operator dapat melakukan pelaporan KTA dan/atau TTA dengan aplikasi Sinergi?"},
    {tipe:"DTS", uk:"UK2", soal:4, text:"Apakah Operator melaporkan malfungsi kondisi unit kepada Pengawas/OCR?"},
    {tipe:"DTS", uk:"UK2", soal:5, text:"Apakah Operator memahami dan malakukan aturan lampu sein?"},
    {tipe:"DTS", uk:"UK2", soal:6, text:"Apakah Operator menggunakan radio komunikasi dengan baik dan benar?"},
    {tipe:"DTS", uk:"UK2", soal:7, text:"Apakah Operator memahami target ritase tiap jam pada fleet tsb?"},
    {tipe:"DTS", uk:"UK2", soal:8, text:"Apakah Operator memahami jumlah passing untuk unit yang dioperasikan?"},

    //UK3
    {tipe:"DTS", uk:"UK3", soal:1, text:"Apakah Operator mengetahui dimensi unit?"},
    {tipe:"DTS", uk:"UK3", soal:2, text:"Apakah Operator mengetahui jarak blind spot unit?"},
    {tipe:"DTS", uk:"UK3", soal:3, text:"Apakah Operator mengetahui fungsi unit?"},
    {tipe:"DTS", uk:"UK3", soal:4, text:"Apakah Operator mengetahui 5 system engine?"},
    {tipe:"DTS", uk:"UK3", soal:5, text:"Apakah Operator mengetahui power train pada unit?"},
    {tipe:"DTS", uk:"UK3", soal:6, text:"Apakah Operator mengetahui kapasitas fuel unit yang dioperasikannya?"},

    //UK4
    {tipe:"DTS", uk:"UK4", soal:1, text:"Apakah Operator memahami fungsi instrumen panel?"},
    {tipe:"DTS", uk:"UK4", soal:2, text:"Apakah Operator memahami cara membaca instrumen panel? Sampling minimal 3"},
    {tipe:"DTS", uk:"UK4", soal:3, text:"Apakah Operator memahami warning category pada instrumen panel?"},
    {tipe:"DTS", uk:"UK4", soal:4, text:"Apakah Operator memahami tindak lanjut jika instrumen panel menyala? Sampling minimal 3"},
    {tipe:"DTS", uk:"UK4", soal:5, text:"Apakah Operator memahami nama control lever & pedal? Sampling minimal 3"},
    {tipe:"DTS", uk:"UK4", soal:6, text:"Apakah Operator memahami fungsi control lever & pedal? Sampling minimal 3"},

    //UK5
    {tipe:"DTS", uk:"UK5", soal:1, text:"Apakah Operator memahami tujuan P2H?"},
    {tipe:"DTS", uk:"UK5", soal:2, text:"Apakah Operator memahami 4 langkah P2H?"},
    {tipe:"DTS", uk:"UK5", soal:3, text:"Apakah Operator melakukan pemeriksaan keliling unit?"},
    {tipe:"DTS", uk:"UK5", soal:4, text:"Apakah Operator memahami komponen yang diperiksa saat keliling unit? Sampling minimal 3"},
    {tipe:"DTS", uk:"UK5", soal:5, text:"Apakah Operator melakukan pemeriksaan diatas unit sebelum engine hidup?"},
    {tipe:"DTS", uk:"UK5", soal:6, text:"Apakah Operator memahami komponen yang diperiksan saat diatas unit sebelum engine hidup? Sampling minimal 3"},
    {tipe:"DTS", uk:"UK5", soal:7, text:"Apakah Operator melakukan pemeriksaan diatas unit setelah engine hidup?"},
    {tipe:"DTS", uk:"UK5", soal:8, text:"Apakah Operator memahami komponen yang diperiksan saat diatas unit setelah engine hidup? Sampling minimal 3"},
    {tipe:"DTS", uk:"UK5", soal:9, text:"Apakah Operator melakukan pemeriksaan setelah operasi?"},
    {tipe:"DTS", uk:"UK5", soal:10, text:"Apakah Operator memahami komponen yang diperiksan setelah operasi? Sampling minimal 3"},
    {tipe:"DTS", uk:"UK5", soal:11, text:"Apakah Operator memahami kode bahaya untuk temuan P2H?"},
    {tipe:"DTS", uk:"UK5", soal:12, text:"Apakah Operator menuliskan temuan P2H pada kertas P2H?"},
    {tipe:"DTS", uk:"UK5", soal:13, text:"Apakah Operator memahami cara mengisi form P2H?"},

    //UK6
    {tipe:"DTS", uk:"UK6", soal:1, text:"Apakah Operator melakukan manuver sebelum loading searah jarum jam?"},
    {tipe:"DTS", uk:"UK6", soal:2, text:"Apakah Operator menempatkan lever transimis pada posisi P saat loading?"},
    {tipe:"DTS", uk:"UK6", soal:3, text:"Apakah Operator tepat menggunakan transmisi saat awal bergerak maju setelah loading?"},
    {tipe:"DTS", uk:"UK6", soal:4, text:"Apakah Operator menggunakan transmisi dan speed sesuai dengan kondisi jalan?"},
    {tipe:"DTS", uk:"UK6", soal:5, text:"Apakah Operator menggunakan Shift Limit & Power Economy Mode sesuai dengan kondisi jalan?"},
    {tipe:"DTS", uk:"UK6", soal:6, text:"Apakah Operator menggunakan brake sesuai dengan kondisi jalan?"},
    {tipe:"DTS", uk:"UK6", soal:7, text:"Apakah Operator menjaga jarak beriringan dengan unit lain â‰¥ 40 m?"},
    {tipe:"DTS", uk:"UK6", soal:8, text:"Apakah Operator mengambil haluan saat belok atau di tikungan dengan tepat?"},
    {tipe:"DTS", uk:"UK6", soal:9, text:"Apakah Operator terampil dalam mengemudi atau pengendalian steering wheel?"},
    {tipe:"DTS", uk:"UK6", soal:10, text:"Apakah Operator TIDAK melakukan neutral coasitng?"},
    {tipe:"DTS", uk:"UK6", soal:11, text:"Apakah Operator TIDAK melakukan abuse shifting?"},
    {tipe:"DTS", uk:"UK6", soal:12, text:"Apakah Operator TIDAK tidak melakukan hunting?"},
    {tipe:"DTS", uk:"UK6", soal:13, text:"Apakah Operator TIDAK melakukan gear select harmfull?"},
    {tipe:"DTS", uk:"UK6", soal:14, text:"Apakah Operator TIDAK melakukan overrunning?"},
    {tipe:"DTS", uk:"UK6", soal:15, text:"Apakah Operator TIDAK melakukan melakukan manuver dengan gerakan patah (end stroke steering)?"},
    {tipe:"DTS", uk:"UK6", soal:16, text:"Apakah Operator melakukan manuver searah jarum jam sebelum dumping?"},
    {tipe:"DTS", uk:"UK6", soal:17, text:"Apakah Operator mengikuti arahan GL Disposal atau dump man untuk titik dumping?"},
    {tipe:"DTS", uk:"UK6", soal:18, text:"Apakah Operator menjaga jarak dumping dengan unit lain?"},
    {tipe:"DTS", uk:"UK6", soal:19, text:"Apakah Operator menggunakan parkirng brake saat dumping?"},
    {tipe:"DTS", uk:"UK6", soal:20, text:"Apakah Operator menggunakan rpm dumping yang tepat?"},
    {tipe:"DTS", uk:"UK6", soal:21, text:"Apakah Operator menurunkan vessel dengan metode yang tepat?"},
    {tipe:"DTS", uk:"UK6", soal:22, text:"Apakah setelah dumping Operator menurunkan vessel terlebih dahulu kemudian mengoperasikan unit?"},
    {tipe:"DTS", uk:"UK6", soal:23, text:"Apakah Operator parkir dalam posisi rata dan aman?"},
    {tipe:"DTS", uk:"UK6", soal:24, text:"Apakah Operator menempatakan lever transmisi pada posisi P saat parkir?"},
    {tipe:"DTS", uk:"UK6", soal:25, text:"Apakah Operator melakukan idle sebelum shut down engine?"},

  ],
  
  EXCOB: [
    {tipe:"EXCOB", uk:"UK1", soal:1, text:"Bucket terkunci dengan benar?"},
    {tipe:"EXCOB", uk:"UK1", soal:2, text:"Operator cek tekanan hidrolik?"},
    {tipe:"EXCOB", uk:"UK1", soal:3, text:"Operator melakukan Tidak dalam keadaan Fatigue?"}
  ]
};

const daftarKaryawan = { //NRP Karyawan
  "30170397": "SLAMET SUMARNO",
  "30221013": "JUMADI",
  "30210924": "GUSTI RICKY FEBRYAN SUKMA",
  "30210677": "ALI HIDAYAT",
  "30180426": "ARIF IBNU WACHID",
  "30210789": "AGUS SALIM SURYANTO",
  "30210526": "HADRI",
  "30180018": "RUDI SUTANTO",
  "30250068": "PRATAMA ADITYA ABDUL RAHMAN",
  "30210395": "BAYU DONI KARDITA",
  "30170305": "RUDI HARTONO",
  "30170269": "SUWANTO",
  "30230358": "MUHAMMAD RAHMAD",
  "30230674": "RIZKI ALFIANDI",
  "30230331": "AHMAD GAZALI 01",
  "30221221": "MUHAMMAD ARSAD",
  "30250053": "SUGIANOR",
  "30210447": "AGUNG WAHYUDI",
  "30170061": "SUDARSONO",
  "30210394": "ZAINUL ARIFIN",
  "30210100": "RIDWAN EFENDI SAPUTRA",
  "30220301": "WIDODO ISWANDI SISWANTO",
  "30210679": "LACIO LUCKY SIMANJUNTAK",
  "30221200": "MUHAMAD ABAS",
  "30210837": "ANDI SANTOSO",
  "30210489": "FHARIZ YOKO KISTOYO",
  "30230415": "RIO BINTORO",
  "30240347": "AGUNG SAMODRA KURNIAWAN",
  "30230227": "SUHARNO",
  "30230859": "AHMAD GAZALI 02",
  "30220363": "AKHMAD RIFANI",
  "30210838": "MUHAMMAD RIZKI 01",
  "30230472": "GITO",
  "30220453": "MUHAMMAD SETIADI",
  "30220255": "MOCHAMAD ANSORI",
  "30230473": "HARYANTO",
  "30250069": "SUPRIADI",
  "30220868": "MUHAMAD AFDAL",
  "30220298": "DIDIK DARWANTO",
  "30180668": "MUHAMMAD TAYYIB",
  "30170393": "DIDIK PURNOMO",
  "30230225": "JANUARI YANTO SIGIT SETIAWAN",
  "30240340": "MUHAMMAD RIKI SETIAWAN",
  "30240342": "M. RIZKI APRILIANOR",
  "30220954": "AKHMAD FAISAL 01",
  "30221242": "AGUS SUPIANI",
  "30221089": "MUHAMMAD ROBBY",
  "30210515": "IWAN SUSILO",
  "30210678": "ADI HERIAWAN",
  "30221220": "MUHAMMAD IRVAN",
  "30220335": "RICKI RIKARDO SIMAMORA",
  "30230325": "AKHMAD MUHYIDIN LUTHPI",
  "30230348": "YOGGA FEBRIANSYAH",
  "30210788": "TEGUH PRAHARA",
  "30230224": "ARDI HARTONO",
  "30250004": "GLEN ARDI NICOLAS HASIBUAN",
  "30221222": "SHAHRIL",
  "30210745": "MUHAMMAD FAUZIANNOR",
  "30250001": "BOWO HARTANTO",
  "30230671": "RAMA MURDANI",
  "30230672": "WARTIMAN",
  "30250066": "KHAIRUL AFANDI",
  "30230673": "PEBRI MALKIN",
  "30250060": "HENGKY MAMAT MAQSUDI",
  "30210347": "IMAM HUSAINI",
  "30210562": "ANANDA MIKULA",
  "30230368": "MUHAMMAD IRPAN",
  "30230337": "M. NAFARIN",
  "30210711": "STEFANUS ALDAN EFRAIM",
  "30170150": "TRIONO YULIANTO",
  "30170270": "UBAIDILLAH AMIN",
  "30180019": "HERRY PADLI",
  "30180009": "IKHWANUDIN",
  "30210387": "TRISDIYANTO",
  "30180028": "MUHAMMAD RASID",
  "30180554": "LADHI EFENDI",
  "30210136": "SIDIQ KURNIADI",
  "30210389": "RICI MUSTAFA",
  "30170257": "GADENG EKO IRIANTO",
  "30210221": "ALI SAPUTRA",
  "30210388": "MUHAMMAD SYARIFUDIN",
  "30210680": "HADI",
  "30180025": "IRWAN SUSANTO",
  "30230126": "MUHAMMAD FAISOL ARIF",
  "30220993": "MUHAMMAD HARIS",
  "30221094": "M. RAHMAN",
  "30220861": "YOGI MARTIYONO",
  "30220545": "REGA PUTRA ISVERIADI PRATAMA",
  "30180611": "RIDUANSYAH",
  "30221241": "ARIF SETIYONO",
  "30210269": "RUDI EKA SETIAWAN",
  "30200499": "MOKHAMAD KHASBI",
  "30220859": "MUHAMMAD BAHARUDDIN SANJAYA",
  "30210480": "KUS SUNARTO",
  "30170255": "M. JUNANTO",
  "30130245": "ALPIANOR",
  "30200483": "KHAIRUN SADIK",
  "30220358": "DEDY SUDARIYANTO",
  "30220371": "YAMANI",
  "30210619": "MAULANA ARIPIN",
  "30170315": "PURWANTO",
  "30230333": "MUHAMMAD AFDAN",
  "30230327": "M. PACHRUDIN",
  "30250072": "MOHAMMAD TAUFIK HIDAYATULLAH",
  "30220352": "AHMAD JARHANI",
  "30220304": "MUHAMMAD FATONI",
  "30170359": "RIYANTO",
  "30250010": "FOMPY SETYADI SIGA",
  "30250015": "BUDI SETIAWAN 02",
  "30230346": "M. SAFRIADI",
  "30180472": "AHMAD BADARUDIN",
  "30250006": "MUHAMMAD FAHMI WISUDAWAN",
  "30230367": "MUHAMMAD IWAN",
  "30230357": "MUHAMMAD REFALDI",
  "30170233": "RIPANI",
  "30170237": "EDI PURWANTO 01",
  "30230356": "MUHAMMAD RUSDIANOR",
  "30170344": "MUHAMMAD TAUFIK",
  "30250049": "YAHDI",
  "30250065": "ABDUL AZIZ",
  "30250067": "MUHAMMAD SAFRUDIN",
  "30240343": "WELLY ALSENDRI",
  "30220319": "AHMAD RIYADI",
  "30250016": "MUKHLIS SAUFI",
  "30250005": "AULIA RAHMAN",
  "30250070": "WAWAN LIANSYAH",
  "30250071": "TEDI SUTIAWAN",
  "30221095": "SARWONO",
  "30230361": "MUHAMMAD GAZALI",
  "30210853": "ALFIN SEPTIANTO",
  "30230228": "MUHAMMAD RIZAL",
  "30210268": "DEDIK MULYONO",
  "30220293": "BADRIANOR",
  "30210007": "ZAMZURI",
  "30130064": "MUHAMMAD AFIF FAUZI",
  "30190010": "AGUS PURWADI",
  "30180601": "NUR HUDA",
  "30180675": "PUJIONO",
  "30180603": "LIMANTO SYAIRUDIN",
  "30210479": "PRAYITNO",
  "30210313": "SUTRISNO",
  "30210049": "NISAN WIDIYANTO",
  "30200504": "SISWOYO",
  "30221157": "AGUS ISWANTO",
  "30220873": "KASMAYADI",
  "30200435": "SAMSI HAMDANI",
  "30220852": "FAISAL RIZA",
  "30200179": "NOR AMIDI",
  "30210092": "BUDI GUNAWAN",
  "30210560": "WAHYUDI 02",
  "30210312": "KANFAU",
  "30220225": "M. RIZKIANOR",
  "30180602": "ADI TRIANTO",
  "30180414": "RORI FADILAH",
  "30200436": "ADE IRMAWAN",
  "30180538": "SURIANI",
  "30240177": "PEBRI IRAWAN",
  "30210874": "AHMAD RIZALDI",
  "30170311": "CHANDRA EKA SETIAWAN",
  "30220344": "HIDAYATURRAHMAN",
  "30210497": "AHCMAD RIZKY PRATAMA",
  "30170209": "WAHYUDI 01",
  "30180515": "MUHAMMAD HAILI",
  "30240179": "YUSAK KRISMANTO",
  "30240176": "KHAIRUL MUIS",
  "30200423": "JUHRANI",
  "30180440": "MUHAPIT",
  "30180425": "KAMALI",
  "30120061": "MUHAMMAD NOR FAJRI",
  "30221045": "FAHRUL RAJI",
  "30230289": "IFAN M",
  "30230010": "KHAIDIR ILMI",
  "30240022": "AKHMAD BAIHAQI",
  "30240016": "M. NASRULLAH",
  "30230158": "WIJI RAHMAT ASFAHANI",
  "30240366": "A. SAPUTRA",
  "30240367": "AHMAD FAUZI",
  "30240371": "MUHAMMAD SYAIFULLAH",
  "30240015": "AKHMAD RIYADI",
  "30230232": "MUHAMMAD BAIHAQI",
  "30230491": "SUCI RAMADANI",
  "30230365": "MUHAMMAD SYAHRONI RAMADHANI",
  "30240376": "AHMAD ADITIYA",
  "30220885": "FERMA MAIDI",
  "30230421": "EKO HADI WIHARNO",
  "30240372": "SURKATI",
  "30230556": "MUHAMMAD RINALDI",
  "30230322": "ABDULLAH",
  "30170300": "AHMAD BAHRI",
  "30230878": "AKHMAD FAISAL 02",
  "30230323": "AHMAD NASHUHA",
  "30230360": "MUHAMMAD KHAIRUL RAMDHANI",
  "30240377": "ALFIAN",
  "30230336": "MUHAMMAD FAHMI IDERIS",
  "30230506": "HUDA FEBRI YUDA",
  "30230165": "ARIF SETIYAWAN",
  "30230374": "HENDRO BUDIARTO",
  "30230470": "MUHAMMAD LUKMAN ZAIRENDRA",
  "30221272": "MUH. NOOR ABIDIN",
  "30240013": "AKHMAD RIANSYAH",
  "30230162": "MUHAMMAD SYARWANI ABDAN",
  "30170313": "HENDRI ANSHARY",
  "30230030": "AHMAD NOOR",
  "30240381": "BUDI SANTOSO",
  "30220851": "ZAINUL",
  "30220357": "RINI HARDANI",
  "30230555": "IQBAL GUNAWAN",
  "30230362": "MUHAMMAD FEBRIANSYAH",
  "30240380": "BAHTIAR SLAMET DWIRIANTO",
  "30240370": "MUHAMMAD RAIHAN HILMI",
  "30230478": "MUHAMMAD RIYANDI",
  "30230551": "SETIYO APRIYANTO",
  "30230471": "MUHAMMAD ZAKIR",
  "30200452": "SANDERI. R",
  "30230480": "MUHAMMAD HENDRI",
  "30221009": "AGUS WAHYUDI 02",
  "30170272": "ABDUL AZIZ RAHMAN",
  "30240192": "DENI APRIADI",
  "30240378": "APRIANOOR",
  "30240341": "MAHRANI",
  "30230554": "RIDHANSYAH",
  "30230231": "HAIRUL RAHMAN",
  "30220667": "MUHAMMAD AFANDI",
  "30240018": "MUHAMMAD ADE PERMANA",
  "30230482": "EDI PURWANTO 02",
  "30240379": "ARY WIBOWO",
  "30230492": "TAUFIK HIDAYAT",
  "30240384": "MUHAMMAD HARTONI",
  "30230488": "M. MAULANA",
  "30240374": "YUSUF RAMADHANI",
  "30240024": "ANGGI WIBAWARTA",
  "30240388": "WIDODO",
  "30210496": "AGUS WAHYUDI 01",
  "30240191": "DARWIN SINAMBELA",
  "30230553": "ALAMSYAH SIREGAR",
  "30230174": "WAHYUDI 03",
  "30230812": "M. MARDIANSYAH",
  "30230515": "YAHYA",
  "30230350": "SURYA ADI PUTRA",
  "30230666": "SU'IT",
  "30240373": "SYARIPUDIN",
  "30230809": "YUSRIL JAUHARI",
  "30221179": "SOFYAN TSAURI",
  "30230324": "AKHMAD MARZUKI",
  "30240017": "EKA SETIA MARDIYANTO, SE",
  "30230670": "DONNY AKBAR",
  "30170381": "ANDI",
  "30221191": "MUHAMMAD ALSANDI",
  "30240386": "TAUFIK RAHMAN 02",
  "30230161": "RIYAN SUSANTO",
  "30230157": "MUHAMAD PUJI SUDARMADI",
  "30230230": "AIDIL",
  "30221198": "MUHAMMAD WENDRI ARYANTO",
  "30230422": "SURIANSYAH",
  "30230175": "M. ANSYARI",
  "30230550": "SAPRUDIN",
  "30230481": "MUHRAJI",
  "30230330": "MUHAMMAD RIFANI",
  "30230552": "NURMANSYAH SAPUTRA",
  "30221194": "JEFRI JUNAIDI",
  "30230479": "DEDI IRAWAN",
  "30230489": "ROHMAT KURDI LUKI",
  "30221273": "MUHAMMAD TOHIR",
  "30221271": "SUGIONO 02",
  "30221010": "HAIRIL SETIAWAN",
  "30221011": "FAHMIANSYAH",
  "30221087": "GALIH MAHARDIKA",
  "30230166": "MUHAMMAD RAMDANI",
  "30220858": "M. FADLY",
  "30221270": "KASMILAN",
  "30230229": "DANU ADI PRANOTO",
  "30221085": "AGUS SUFIYAN SAURI",
  "30240387": "WAHYU SUPRIHATIN",
  "30240368": "DARMANTO",
  "30240369": "IBNU NOVARIANTO",
  "30240385": "MUHAMMAD RIZKI 02",
  "30240383": "INDRA PRASETYO",
  "30240382": "HERMANTO",
  "30220983": "PRAMONO",
  "30221047": "RIO WAHYU SANTOSO",
  "30210366": "GIYANTO",
  "30220265": "MUHAMMAD ADITYA",
  "30221012": "WARDANIANSYAH",
  "30220886": "AHMAT GAZALI",
  "30220995": "MUHAMMAD NOR",
  "30220038": "EKO AGUS SETIAWAN",
  "30220300": "GUNAWAN ARIES PRADANA",
  "30220264": "ARDIANSYAH",
  "30220618": "NURUL IKHSAN",
  "30221206": "ANDI NOVIA RAHMAN",
  "30221043": "DIDI WARDANI",
  "30210694": "MUHAMMAD ALI",
  "30220863": "MUHAMMAD MIDUN",
  "30220847": "AGUNG SUWARDIANTO",
  "30220826": "MUHAMMAD SALEH",
  "30180007": "ARIYANTO",
  "30220864": "MUH. ADI SYAFAAT",
  "30220963": "SAHRUL RAMADANI",
  "30220862": "HAIRUNI",
  "30230063": "SARKANI",
  "30230083": "MARWAN",
  "30210610": "MUSLIYANI",
  "30220470": "ANTON SUJARWO",
  "30220961": "DES YANUR",
  "30180012": "MUHAMMAD BADALI",
  "30180015": "SUGIONO 01",
  "30210640": "NASRULLAH",
  "30210641": "SAIBOLAH",
  "30220853": "RIFKI YANTO",
  "30221218": "MUHAMMAD ILHAM",
  "30221197": "HENDRIANNOOR",
  "30220883": "SUDARMONO",
  "30170383": "SUYANTO",
  "30170293": "ENDRI YANTO",
  "30160059": "AKHMAD SURIYADI",
  "30210545": "DELLY RAHMATULLAH",
  "30221088": "MUHAMMAD SA'DILLAH",
  "30220856": "ANDRI ASYONI",
  "30210335": "ABDUL MAJID",
  "30140084": "ROKHWAN",
  "30210326": "AGUS MAULANA",
  "30210324": "NAJEMULLAH",
  "30210367": "SUGIYONO",
  "30210461": "MUHAMMAD KURNIA SANDY",
  "30160005": "TIK SUSANTO",
  "30110113": "FAHRIANSYAH",
  "30220263": "DEBY ARDIANTO",
  "30210780": "IHWAN MAULANA",
  "30220994": "ALI SAHBANA",
  "30210407": "JOKO SANTOSO",
  "30210547": "MUHAMMAD IQBAL 03",
  "30180652": "ABDUL GAPUR",
  "30170009": "SISWANTO",
  "30220962": "SYAIFUL RAHMAN",
  "30210709": "SYAPRIANSYAH",
  "30210355": "FAKHRIADY",
  "30210495": "MUHAMMAD GUSRIANSYAH",
  "30170384": "HUMAIDI",
  "30210602": "M. FAHRUDIN",
  "30180591": "KASRANI",
  "30200478": "MUHAMAD JIADI",
  "30180438": "M. SYAIFUL ANWAR",
  "30140045": "ZAINI",
  "30210328": "WAGINO",
  "30210644": "MUHAMMAD SALMAN",
  "30180045": "AHMAD SODIKIN",
  "30220809": "YUSRIL MAHENDRA",
  "30170371": "EDI SANTOSO",
  "30180006": "MUHAFIQ",
  "30170386": "MUHAMMAD AHYANI",
  "30170389": "MUHLIS",
  "30180011": "RIZKI DEWANTARA",
  "30180592": "ANDI KELANA",
  "30170390": "RUPII HAMDI",
  "30210687": "BAMBANG IRAWANTO",
  "30210690": "ALI JAINAL ABIDIN",
  "30210360": "IWAN SAPUTRA",
  "30210359": "HIDAYATUL AKBAR",
  "30210391": "PALEN SUPRIANTO",
  "30210336": "RIZAL HADI",
  "30220984": "ILFANS DWI CAHYO",
  "30210341": "AHMAD KHAIRANI",
  "30210095": "HERLIYANNOR",
  "30220489": "MARJUKI",
  "30221165": "HAIRI",
  "30180632": "SURONO",
  "30170162": "NURHAN ARIYANTO",
  "30180616": "EKO BAGUS STYAWAN",
  "30180561": "FIRMANSYAH",
  "30210546": "RAHMAD HIDAYAT",
  "30210094": "MUHAMMAD PAJRIN",
  "30210022": "TAUFIK RAHMAN 01",
  "30170228": "TUTUT WIJAYANTO",
  "30180593": "TARHIM",
  "30180521": "DWI DEDI SANJAYA",
  "30180633": "SYAMSURI",
  "30220992": "ARIF SETIAWAN",
  "30130045": "MUHAMMAD RAHMAN",
  "30210741": "RAHMAN",
  "30120117": "RIFAN WAHYUDI",
  "30180663": "MUHAMMAD IMANSYAH",
  "30180518": "SUYITNO",
  "30180606": "BAKTI PUTRA PEBRILITA",
  "30210691": "ZULKIFLI",
  "30160023": "YOYOK RAHMAT WIBOWO",
  "30180439": "EDI IRAWAN",
  "30180020": "MUHAMMAD HUSAINI",
  "30220933": "MUHAMMAD",
  "30140100": "ZAINUL FANANI",
  "30140090": "SOGIANOR",
  "30180441": "AHMAD BAIHAQI",
  "30180016": "NASRULLAH JAMIL",
  "30180429": "BAMBANG HARIADI",
  "30180428": "BAMBANG HARIYANTO",
  "30220844": "EKO SULISTYONO",
  "30170043": "MUHAMMAD SISWANTO",
  "30180638": "RIDHA RIFKY",
  "30120111": "SUTONO",
  "30140091": "JOKO SUTRISNO",
  "30120054": "PURNOMO",
  "30130298": "SUTOMI MUSTAR",
  "30140034": "KRISTIONO",
  "30170316": "MUHAMMAD ARSYAD",
  "30170360": "ROBIYANTO",
  "30170400": "ROZIN TAMPA ROSYAD",
  "30200449": "PAHRIADI",
  "30200450": "MUHAMMAD SYARPANI",
  "30210011": "MUHAMMAD KHASBI",
  "30210118": "MUHAMMAD NAUFAL",
  "30210240": "TAUFIK NABAWI",
  "30210431": "MOHAMMAD TEGUH PRAKOSO",
  "30210454": "MARIYADI",
  "30210544": "AKHMAD MASRUDI",
  "30210580": "ARIEF DWIYANTO",
  "30220406": "KHAIRANI",
  "30220407": "MUHAMMAD HAFIZ FAHMI",
  "30220408": "M. ZANI ISMAIL",
  "30220409": "FEBRIANSYAH",
  "30220410": "ABDUL HADI AMRULLAH",
  "30220411": "SYAIFUR RAHMAN",
  "30220412": "ARI LUFIYANSYAH",
  "30220527": "ZAINUDDIN",
  "30221042": "ZAMALUDIN",
  "30230221": "AHMAD YANI",
  "30230291": "HARIS HARWANDI",
  "30230347": "M. GAZALI",
  "30220927": "M. HENDERA",
  "30230352": "RIFKI RAMADHAN",
  "30230355": "MUHAMMAD QUSAIRI",
  "30230363": "MUHAMMAD FAJAR",
  "30240180": "MUHAMMAD MIRAJUL",
  "30240319": "EDWIN LABINTANG",
  "30250036": "MUHAMMAD KHAIRUR RAHMAN",
  "30230280": "MISRAN",
  "30230477": "ZAINAL ILMI",
  "30170116": "USMAN",
  "30230876": "RAHMAN"
};

let jawaban = {};

function loadSoal() {
    const unit = document.getElementById("unit").value;
    const container = document.getElementById("soalContainer");
    container.innerHTML = "";
    jawaban = {}; // Reset jawaban saat ganti unit

    if (!bankSoal[unit]) return;

    bankSoal[unit].forEach(s => {
        const key = `${s.tipe}|${s.uk}|${s.soal}`;
        container.innerHTML += `
        <div class="soal" data-key="${key}">
            <p>${s.text}</p>
            <button class="btn-ya" onclick="jawab(this, 1)">YA</button>
            <button class="btn-tidak" onclick="jawab(this, 0)">TIDAK</button>
            <button class="btn-tdk-uji" onclick="jawab(this, -1)">TIDAK DIUJI</button>
            <div class="followup"></div>
        </div>`;
    });
}

function cariNama() {
    const nrpInput = document.getElementById("nrp").value;
    const namaInput = document.getElementById("nama");
    
    // Cek apakah NRP ada di database daftarKaryawan
    if (daftarKaryawan[nrpInput]) {
        namaInput.value = daftarKaryawan[nrpInput];
    } else {
        // Jika NRP belum lengkap atau tidak ada, kosongkan kolom nama
        namaInput.value = "";
    }
}

function jawab(btn, nilai) {
    const div = btn.closest(".soal");
    const follow = div.querySelector(".followup");
    const key = div.dataset.key;

    // Inisialisasi object jika belum ada
    jawaban[key] = { nilai: nilai };

    // Reset warna tombol utama
    div.querySelectorAll(":scope > button").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");

    follow.innerHTML = "";

    if (nilai === 0) {
        follow.innerHTML = `
            <div style="margin-top:10px; border-top:1px dashed #ccc; padding-top:10px;">
                <p style="font-size:14px; margin-bottom:5px;"><b>OFR (On-Field Refreshment):</b></p>
                <button type="button" class="btn-ofr-ya" onclick="jawabOFR(this, '${key}', 1)">YA</button>
                <button type="button" class="btn-ofr-tidak" onclick="jawabOFR(this, '${key}', 0)">TIDAK</button>
            </div>
        `;
    } else if (nilai === -1) {
        follow.innerHTML = `
            <div style="margin-top:10px;">
                <p style="font-size:14px; margin-bottom:5px;"><b>Alasan Tidak Diuji:</b></p>
                <input type="text" placeholder="Tulis alasan..." 
                       style="width:100%; padding:10px; border-radius:8px; border:1px solid #ccc;"
                       oninput="updateAlasan('${key}', this.value)">
            </div>
        `;
    }
}

function jawabOFR(btn, key, nilai) {
    if (jawaban[key]) {
        jawaban[key].ofr = nilai;
    }
    // Mencari button di dalam container followup saja
    const container = btn.parentElement;
    container.querySelectorAll("button").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
}

function updateAlasan(key, text) {
    if (jawaban[key]) {
        jawaban[key].alasan = text;
    }
}

function submitForm() {
  tampilkanSummary(); // hanya tampilkan
}

function kirimFinal() {
  const scriptURL = 'https://script.google.com/macros/s/AKfycby-_edOnvMKQyHheArcR5PAA1YJwAtf8sTZuzLmXdmgg8tjMlppHzrP65K4eAMTxuVD/exec';
  const btn = document.getElementById("btnKirimFinal");

    // 1. Hitung Nilai
    let ya = Object.values(jawaban).filter(j => j.nilai === 1).length;
    let tidak = Object.values(jawaban).filter(j => j.nilai === 0).length;
    let nilaiHasil = (ya + tidak) > 0 ? Math.round((ya / (ya + tidak)) * 100) : 0;

    // 2. Siapkan Objek Data
    const data = {
        nama: document.getElementById("nama").value,
        nrp: document.getElementById("nrp").value,
        unit: document.getElementById("unit").value,
        no_unit: document.getElementById("No_Unit").value,
        evaluator: document.getElementById("Evaluator").value,
        tanggal: document.getElementById("Tanggal_evaluasi").value,
        nilai_akhir: nilaiHasil, 
        hasil_jawaban: []
    };

    // 3. Masukkan Jawaban (HANYA SATU KALI SAJA)
    Object.keys(jawaban).forEach(key => {
        data.hasil_jawaban.push({
            soal_id: key,
            data: jawaban[key]
        });
    });

    // 4. Validasi Data
    if (!data.nama || !data.unit) {
        alert("Nama dan Unit wajib diisi!");
        return;
    }

    if (!data.nrp || isNaN(data.nrp)) {
        alert("NRP harus berupa angka!");
        return;
    }

    // 5. Eksekusi Pengiriman
    btn.innerText = "MENGIRIM...";
    btn.disabled = true;

    fetch(scriptURL, {
        method: "POST",
        headers: {
            "Content-Type": "text/plain;charset=utf-8"
        },
        body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(res => {
        if(res.status === "success"){
            alert("Data Berhasil Terkirim!");
            location.reload();
        } else {
            alert("ERROR SPREADSHEET: " + res.message);
            btn.innerText = "KIRIM DATA";
            btn.disabled = false;
        }
    })
    .catch(err => {
        alert("Gagal menghubungi server.");
        console.error(err);
        btn.innerText = "KIRIM DATA";
        btn.disabled = false;
    });
}

function tampilkanSummary() {
    let ya = 0, tidak = 0, tdkUji = 0;

    if (Object.keys(jawaban).length === 0) {
        alert("Anda belum menjawab soal apapun!");
        return;
    }

    Object.values(jawaban).forEach(j => {
        if (j.nilai === 1) ya++;
        else if (j.nilai === 0) tidak++;
        else if (j.nilai === -1) tdkUji++;
    });

    // HITUNG NILAI
    // Rumus: (YA / (YA + TIDAK)) * 100
    // Kita pakai Math.round agar tidak ada angka desimal panjang
    let totalDiuji = ya + tidak;
    let nilaiAkhir = 0;
    
    if (totalDiuji > 0) {
        nilaiAkhir = Math.round((ya / totalDiuji) * 100);
    }

    // Isi data ke modal
    document.getElementById("sumTotal").innerText = ya + tidak + tdkUji;
    document.getElementById("sumYa").innerText = ya;
    document.getElementById("sumTidak").innerText = tidak;
    document.getElementById("sumTdkUji").innerText = tdkUji;
    
    // Tampilkan Nilai
    document.getElementById("sumNilai").innerText = nilaiAkhir + " / 100";

    // Munculkan Modal
    document.getElementById("modalOverlay").style.display = "block";
    document.getElementById("summaryBox").style.display = "block";
}

function closeSummary() {
    // Sembunyikan Modal dan Overlay
    document.getElementById("modalOverlay").style.display = "none";
    document.getElementById("summaryBox").style.display = "none";
}